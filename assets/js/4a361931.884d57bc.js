"use strict";(self.webpackChunkGATK_SV=self.webpackChunkGATK_SV||[]).push([[555],{4020:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"execution/single","title":"Single-sample","description":"Run the pipeline on a single sample","source":"@site/docs/execution/single.md","sourceDirName":"execution","slug":"/execution/single","permalink":"/gatk-sv/docs/execution/single","draft":false,"unlisted":false,"editUrl":"https://github.com/broadinstitute/gatk-sv/tree/master/website/docs/execution/single.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Single-sample","description":"Run the pipeline on a single sample","sidebar_position":3,"slug":"single"},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/gatk-sv/docs/execution/overview"},"next":{"title":"Joint calling","permalink":"/gatk-sv/docs/execution/joint"}}');var s=i(4848),r=i(8453);const l={title:"Single-sample",description:"Run the pipeline on a single sample",sidebar_position:3,slug:"single"},a=void 0,d={},o=[{value:"Introduction",id:"introduction",level:2},{value:"Terra workspace",id:"terra-workspace",level:2},{value:"Data",id:"data",level:2},{value:"Case sample",id:"case-sample",level:3},{value:"Reference panel",id:"reference-panel",level:3},{value:"Reference resources",id:"reference-resources",level:3},{value:"Single sample workflow",id:"single-sample-workflow",level:2},{value:"What does it do?",id:"what-does-it-do",level:3},{value:"What does it require as input?",id:"what-does-it-require-as-input",level:4},{value:"Additional workspace-level inputs",id:"additional-workspace-level-inputs",level:4},{value:"What does it return as output?",id:"what-does-it-return-as-output",level:4},{value:"Example time and cost run on sample data",id:"example-time-and-cost-run-on-sample-data",level:4},{value:"To use this workflow on your own data",id:"to-use-this-workflow-on-your-own-data",level:4},{value:"Quality control",id:"quality-control",level:4}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Extending SV detection to small datasets"})}),"\n",(0,s.jsx)(n.p,{children:"The Single Sample pipeline is designed to facilitate running the methods developed for the cohort-mode GATK-SV pipeline on small data sets or in\nclinical contexts where batching large numbers of samples is not an option. To do so, it uses precomputed data, SV calls,\nand model parameters computed by the cohort pipeline on a reference panel composed of similar samples. The pipeline integrates this\nprecomputed information with signals extracted from the input CRAM file to produce a call set similar in quality to results\ncomputed by the cohort pipeline in a computationally tractable and reproducible manner."}),"\n",(0,s.jsx)(n.h2,{id:"terra-workspace",children:"Terra workspace"}),"\n",(0,s.jsxs)(n.p,{children:["Users should clone the ",(0,s.jsx)(n.a,{href:"https://app.terra.bio/#workspaces/help-gatk/GATK-Structural-Variants-Single-Sample",children:"Terra single-sample workspace"}),"\nwhich is configured with a demo sample to run on.\nRefer to the following sections for instructions on how to run the pipeline on your data using this workspace."]}),"\n",(0,s.jsx)(n.h2,{id:"data",children:"Data"}),"\n",(0,s.jsx)(n.h3,{id:"case-sample",children:"Case sample"}),"\n",(0,s.jsxs)(n.p,{children:["The default workspace includes a NA12878 input WGS CRAM file configured in the workspace samples data table. This file is part of the\nhigh coverage (30X) ",(0,s.jsx)(n.a,{href:"https://www.internationalgenome.org/data-portal/data-collection/30x-grch38",children:"WGS data"})," for the 1000\nGenomes Project samples generated by the New York Genome Center and hosted in\n",(0,s.jsx)(n.a,{href:"https://app.terra.bio/#workspaces/anvil-datastorage/1000G-high-coverage-2019",children:"AnVIL"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"reference-panel",children:"Reference panel"}),"\n",(0,s.jsx)(n.p,{children:"The reference panel configured in the workspace consists of data and calls computed from 156 publicly available samples\nchosen from the NYGC/AnVIL 1000 Genomes high coverage data linked above."}),"\n",(0,s.jsx)(n.p,{children:"Inputs to the pipeline for the reference panel include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A precomputed SV callset VCF, and joint-called depth-based CNV call files"}),"\n",(0,s.jsx)(n.li,{children:"Raw calls for the reference panel samples from Manta and WHAM"}),"\n",(0,s.jsx)(n.li,{children:"Trained models for calling copy number variation in GATK gCNV case mode"}),"\n",(0,s.jsx)(n.li,{children:"Parameters learned by the cohort mode pipeline in training machine learning models on the reference panel samples."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:'These resources are primarily configured in the "Workspace Data" for this workspace. However, several of the resources need\nto be passed  to the workflow as large lists of files or strings. Due to Terra limitations on uploading data containing lists to the\nworkspace data table, these resources are specified directly in the workflow configuration.'}),"\n",(0,s.jsx)(n.h3,{id:"reference-resources",children:"Reference resources"}),"\n",(0,s.jsx)(n.p,{children:"The pipeline uses a number of resource and data files computed for the hg38 reference:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Reference sequences and indices"}),"\n",(0,s.jsx)(n.li,{children:"Genome annotation tracks such as segmental duplication and RepeatMasker tracks"}),"\n",(0,s.jsx)(n.li,{children:"Data used for annotation of called variants, including GenCode gene annotations and gnomAD site allele frequencies."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"single-sample-workflow",children:"Single sample workflow"}),"\n",(0,s.jsx)(n.h3,{id:"what-does-it-do",children:"What does it do?"}),"\n",(0,s.jsxs)(n.p,{children:["The workflow ",(0,s.jsx)(n.code,{children:"gatk-sv-single-sample"})," calls structural variations on a single input CRAM by running the GATK-SV Single Sample Pipeline end-to-end."]}),"\n",(0,s.jsx)(n.h4,{id:"what-does-it-require-as-input",children:"What does it require as input?"}),"\n",(0,s.jsx)(n.p,{children:"The workflow accepts a single CRAM or BAM file as input, configured in the following parameters:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Input Type"}),(0,s.jsx)(n.th,{children:"Input Name"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sample_id"})}),(0,s.jsx)(n.td,{children:"Case sample identifier"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bam_or_cram_file"})}),(0,s.jsx)(n.td,{children:"Path to the GCS location of the input CRAM or BAM file"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"batch"})}),(0,s.jsx)(n.td,{children:"Arbitrary name to be assigned to the run"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"additional-workspace-level-inputs",children:"Additional workspace-level inputs"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Reference resources for hg38"}),"\n",(0,s.jsx)(n.li,{children:"Input data for the reference panel"}),"\n",(0,s.jsx)(n.li,{children:"The set of docker images used in the pipeline."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Please contact GATK-SV developers if you are interested in customizing these\ninputs beyond their defaults."}),"\n",(0,s.jsx)(n.h4,{id:"what-does-it-return-as-output",children:"What does it return as output?"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Output Type"}),(0,s.jsx)(n.th,{children:"Output Name"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"final_vcf"})}),(0,s.jsx)(n.td,{children:"SV VCF output for the pipeline. Includes all sites genotyped as variant in the case sample and genotypes for the reference panel. Sites are annotated with overlap of functional genome elements and allele frequencies of matching variants in gnomAD"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"final_vcf_idx"})}),(0,s.jsxs)(n.td,{children:["Index file for ",(0,s.jsx)(n.code,{children:"final_vcf"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"final_bed"})}),(0,s.jsx)(n.td,{children:"Final output in BED format. Filter status, list of variant samples, and all VCF INFO fields are reported as additional columns."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"metrics_file"})}),(0,s.jsx)(n.td,{children:"Metrics computed from the input data and intermediate and final VCFs. Includes metrics on the SV evidence, and on the number of variants called, broken down by type and size range."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"qc_file"})}),(0,s.jsxs)(n.td,{children:["Quality-control check file. This extracts several key metrics from the ",(0,s.jsx)(n.code,{children:"metrics_file"})," and compares them to pre-specified threshold values. If any QC checks evaluate to FAIL, further diagnostics may be required."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ploidy_matrix"})}),(0,s.jsx)(n.td,{children:"Matrix of contig ploidy estimates computed by GATK gCNV."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ploidy_plots"})}),(0,s.jsxs)(n.td,{children:["Plots of contig ploidy generated from ",(0,s.jsx)(n.code,{children:"ploidy_matrix"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"non_genotyped_unique_depth_calls"})}),(0,s.jsx)(n.td,{children:"This VCF file contains any depth based calls made in the case sample that did not pass genotyping checks and do not match a depth-based call from the reference panel. If very high sensitivity is desired, examine this file for additional large CNV calls."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"non_genotyped_unique_depth_calls_idx"})}),(0,s.jsxs)(n.td,{children:["Index file for ",(0,s.jsx)(n.code,{children:"non_genotyped_unique_depth_calls"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pre_cleanup_vcf"})}),(0,s.jsx)(n.td,{children:"VCF output in a representation used internally in the pipeline. This file is less compliant with the VCF spec and is intended for debugging purposes."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"File"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"pre_cleanup_vcf_idx"})}),(0,s.jsxs)(n.td,{children:["Index file for ",(0,s.jsx)(n.code,{children:"pre_cleanup_vcf"})]})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"example-time-and-cost-run-on-sample-data",children:"Example time and cost run on sample data"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Sample Name"}),(0,s.jsx)(n.th,{children:"Sample Size"}),(0,s.jsx)(n.th,{children:"Time"}),(0,s.jsx)(n.th,{children:"Cost $"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"NA12878"}),(0,s.jsx)(n.td,{children:"18.17 GiB"}),(0,s.jsx)(n.td,{children:"23hrs"}),(0,s.jsx)(n.td,{children:"~$7.34"})]})})]}),"\n",(0,s.jsx)(n.h4,{id:"to-use-this-workflow-on-your-own-data",children:"To use this workflow on your own data"}),"\n",(0,s.jsx)(n.p,{children:"If you would like to run this workflow on your own samples (which must be medium-to-high coverage WGS data):"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Clone the ",(0,s.jsx)(n.a,{href:"https://app.terra.bio/#workspaces/help-gatk/GATK-Structural-Variants-Single-Sample",children:"workspace"})," into a Terra project you have access to.\nSelect ",(0,s.jsx)(n.code,{children:"us-central1"})," for the region. If you must use a different region, you will need to copy all GATK-SV docker images to the other region\nbefore running the pipeline. See the ",(0,s.jsx)(n.a,{href:"/docs/gs/dockers#regions-important",children:"docker images section"})," for details."]}),"\n",(0,s.jsxs)(n.li,{children:["In the cloned workspace, upload rows to the Sample and (optionally) the Participant Data Table that describe your samples.\nEnsure that the rows you add to the Sample table contain the columns ",(0,s.jsx)(n.code,{children:"sample_id"})," and ",(0,s.jsx)(n.code,{children:"bam_or_cram_file"})," are populated appropriately."]}),"\n",(0,s.jsx)(n.li,{children:"There is no need to modify values in the workspace data or method configuration. If you are interested in modifying the reference\ngenome resources or reference panel, please contact the GATK team for support as listed below."}),"\n",(0,s.jsx)(n.li,{children:'Launch the workflow from the "Workflows" tab, selecting your samples as the inputs.'}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"quality-control",children:"Quality control"}),"\n",(0,s.jsxs)(n.p,{children:["Please check the ",(0,s.jsx)(n.code,{children:"qc_file"})," output to screen for data quality issues. This file provides a table of quality metrics and\nsuggested acceptable ranges."]}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:["If a metric exceeds the recommended range, all variants will be automatically flagged with\na non-passing ",(0,s.jsx)(n.code,{children:"FILTER"})," status in the output VCF."]})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var t=i(6540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);