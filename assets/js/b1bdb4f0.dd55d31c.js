"use strict";(globalThis.webpackChunkGATK_SV=globalThis.webpackChunkGATK_SV||[]).push([[6790],{7797(e,t,i){i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>f,frontMatter:()=>o,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"modules/filter_batch","title":"FilterBatch","description":"Filter Batch","source":"@site/docs/modules/filter_batch.md","sourceDirName":"modules","slug":"/modules/fb","permalink":"/gatk-sv/docs/modules/fb","draft":false,"unlisted":false,"editUrl":"https://github.com/broadinstitute/gatk-sv/tree/master/website/docs/modules/filter_batch.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"FilterBatch","description":"Filter Batch","sidebar_position":7,"slug":"fb"},"sidebar":"tutorialSidebar","previous":{"title":"GenerateBatchMetrics","permalink":"/gatk-sv/docs/modules/gbm"},"next":{"title":"MergeBatchSites","permalink":"/gatk-sv/docs/modules/msites"}}');var n=i(4848),r=i(8453),s=i(1944);const o={title:"FilterBatch",description:"Filter Batch",sidebar_position:7,slug:"fb"},d=void 0,a={},c=[{value:"Inputs",id:"inputs",level:3},{value:"<code>batch</code>",id:"batch",level:4},{value:"<code>*_vcf</code>",id:"_vcf",level:4},{value:"<code>evidence_metrics</code>",id:"evidence_metrics",level:4},{value:"<code>outlier_cutoff_nIQR</code>",id:"outlier_cutoff_niqr",level:4},{value:"<HighlightOptionalArg>Optional</HighlightOptionalArg>  <code>outlier_cutoff_table</code>",id:"optional--outlier_cutoff_table",level:4},{value:"<HighlightOptionalArg>Optional</HighlightOptionalArg>  <code>adjudicate_cutoffs</code>",id:"optional--adjudicate_cutoffs",level:4},{value:"<HighlightOptionalArg>Optional</HighlightOptionalArg>  <code>adjudicate_scores</code>",id:"optional--adjudicate_scores",level:4},{value:"<HighlightOptionalArg>Optional</HighlightOptionalArg>  <code>adjudicate_rf_files</code>",id:"optional--adjudicate_rf_files",level:4},{value:"Outputs",id:"outputs",level:3},{value:"<code>filtered_depth_vcf</code>",id:"filtered_depth_vcf",level:4},{value:"<code>filtered_pesr_vcf</code>",id:"filtered_pesr_vcf",level:4},{value:"<code>cutoffs</code>",id:"cutoffs",level:4},{value:"<code>sv_counts</code>",id:"sv_counts",level:4},{value:"<code>sv_count_plots</code>",id:"sv_count_plots",level:4},{value:"<code>outlier_samples_excluded_file</code>",id:"outlier_samples_excluded_file",level:4},{value:"<code>filtered_batch_samples_file</code>",id:"filtered_batch_samples_file",level:4}];function h(e){const t={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",ol:"ol",p:"p",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://github.com/broadinstitute/gatk-sv/blob/main/wdl/FilterBatch.wdl",children:"WDL source code"})}),"\n",(0,n.jsx)(t.p,{children:"Filters poor quality variants and outlier samples.\nThis workflow can be run all at once with the top-level WDL,\nor it can be run in two steps to enable tuning of outlier\nfiltration cutoffs. The two subworkflows are:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://github.com/broadinstitute/gatk-sv/blob/main/wdl/FilterBatchSites.wdl",children:"FilterBatchSites"}),": Per-batch variant filtration.\nVisualize filtered SV counts per sample per type to help choose an IQR cutoff for outlier sample filtering, and preview\noutlier samples for a given cutoff."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://github.com/broadinstitute/gatk-sv/blob/main/wdl/FilterBatchSamples.wdl",children:"FilterBatchSamples"}),": Per-batch outlier sample filtration;\nprovide an appropriate ",(0,n.jsx)(t.a,{href:"#outlier_cutoff_niqr",children:"outlier_cutoff_nIQR"})," based on the\nSV count plots and outlier previews from step 2. Note\nthat not removing high outliers can result in increased\ncompute cost and a higher false positive rate in later steps."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The following diagram illustrates the recommended invocation order:"}),"\n",(0,n.jsx)(t.mermaid,{value:"\nstateDiagram\n  direction LR\n  \n  classDef inModules stroke-width:0px,fill:#caf0f8,color:#00509d\n  classDef thisModule font-weight:bold,stroke-width:0px,fill:#ff9900,color:white\n  classDef outModules stroke-width:0px,fill:#caf0f8,color:#00509d\n\n  gbm: GenerateBatchMetrics\n  fb: FilterBatch\n  mbs: MergeBatchSites\n  gbm --\x3e fb\n  fb --\x3e mbs\n  \n  class fb thisModule\n  class gbm inModules\n  class mbs outModules"}),"\n",(0,n.jsx)(t.h3,{id:"inputs",children:"Inputs"}),"\n",(0,n.jsx)(t.h4,{id:"batch",children:(0,n.jsx)(t.code,{children:"batch"})}),"\n",(0,n.jsxs)(t.p,{children:["An identifier for the batch. Should match the name used in ",(0,n.jsx)(t.a,{href:"./gbe#batch",children:"GatherBatchEvidence"}),"."]}),"\n",(0,n.jsx)(t.h4,{id:"_vcf",children:(0,n.jsx)(t.code,{children:"*_vcf"})}),"\n",(0,n.jsxs)(t.p,{children:["Clustered VCFs from ",(0,n.jsx)(t.a,{href:"./cb#clustered__vcf",children:"ClusterBatch"})]}),"\n",(0,n.jsx)(t.h4,{id:"evidence_metrics",children:(0,n.jsx)(t.code,{children:"evidence_metrics"})}),"\n",(0,n.jsxs)(t.p,{children:["Metrics table ",(0,n.jsx)(t.a,{href:"./gbm#metrics",children:"GenerateBatchMetrics"})]}),"\n",(0,n.jsx)(t.h4,{id:"outlier_cutoff_niqr",children:(0,n.jsx)(t.code,{children:"outlier_cutoff_nIQR"})}),"\n",(0,n.jsxs)(t.p,{children:["Defines outlier sample cutoffs based on variant counts. Samples deviating from the batch median count by more than\nthe given multiple of the interquartile range are hard filtered from the VCF. Recommended range is between ",(0,n.jsx)(t.code,{children:"3"})," and ",(0,n.jsx)(t.code,{children:"9"}),"\ndepending on desired sensitivity (higher is less stringent), or disable with ",(0,n.jsx)(t.code,{children:"10000"}),"."]}),"\n",(0,n.jsxs)(t.h4,{id:"optional--outlier_cutoff_table",children:[(0,n.jsx)(s.$,{children:"Optional"}),"  ",(0,n.jsx)(t.code,{children:"outlier_cutoff_table"})]}),"\n",(0,n.jsxs)(t.p,{children:["A cutoff table to set permissible nIQR ranges for each SVTYPE. If provided, overrides ",(0,n.jsx)(t.code,{children:"outlier_cutoff_nIQR"}),". Expected\ncolumns are: ",(0,n.jsx)(t.code,{children:"algorithm"}),", ",(0,n.jsx)(t.code,{children:"svtype"}),", ",(0,n.jsx)(t.code,{children:"lower_cuff"}),", ",(0,n.jsx)(t.code,{children:"higher_cff"}),". See the ",(0,n.jsx)(t.code,{children:"outlier_cutoff_table"})," resource in\n",(0,n.jsx)(t.a,{href:"https://github.com/broadinstitute/gatk-sv/blob/main/inputs/values/ref_panel_1kg.json",children:"this json"})," for an example table."]}),"\n",(0,n.jsxs)(t.h4,{id:"optional--adjudicate_cutoffs",children:[(0,n.jsx)(s.$,{children:"Optional"}),"  ",(0,n.jsx)(t.code,{children:"adjudicate_cutoffs"})]}),"\n",(0,n.jsx)(t.p,{children:"A pre-computed table of random forest cutoffs that override the table that is generated in the workflow. It ensures\nthat the workflow does not re-run the random forest model training if cutoffs are already available, or if\nsetting these in a manual manner is desired."}),"\n",(0,n.jsxs)(t.h4,{id:"optional--adjudicate_scores",children:[(0,n.jsx)(s.$,{children:"Optional"}),"  ",(0,n.jsx)(t.code,{children:"adjudicate_scores"})]}),"\n",(0,n.jsx)(t.p,{children:"A pre-computed table of variant scores that override the table that is generated in the workflow. It ensures\nthat the workflow does not re-run the random forest model evaluation if scores are already available, or if\nsetting these in a manual manner is desired."}),"\n",(0,n.jsxs)(t.h4,{id:"optional--adjudicate_rf_files",children:[(0,n.jsx)(s.$,{children:"Optional"}),"  ",(0,n.jsx)(t.code,{children:"adjudicate_rf_files"})]}),"\n",(0,n.jsx)(t.p,{children:"A pre-computed series of interemediete random forest files that override what is generated in the workflow.\nIt ensures that the workflow does not re-save these intermediete files if they are already available."}),"\n",(0,n.jsx)(t.h3,{id:"outputs",children:"Outputs"}),"\n",(0,n.jsx)(t.h4,{id:"filtered_depth_vcf",children:(0,n.jsx)(t.code,{children:"filtered_depth_vcf"})}),"\n",(0,n.jsx)(t.p,{children:"Depth-based CNV caller VCFs after variant and sample filtering."}),"\n",(0,n.jsx)(t.h4,{id:"filtered_pesr_vcf",children:(0,n.jsx)(t.code,{children:"filtered_pesr_vcf"})}),"\n",(0,n.jsx)(t.p,{children:"PE/SR (non-depth) caller VCFs after variant and sample filtering."}),"\n",(0,n.jsx)(t.h4,{id:"cutoffs",children:(0,n.jsx)(t.code,{children:"cutoffs"})}),"\n",(0,n.jsx)(t.p,{children:"Variant metric cutoffs for genotyping."}),"\n",(0,n.jsx)(t.h4,{id:"sv_counts",children:(0,n.jsx)(t.code,{children:"sv_counts"})}),"\n",(0,n.jsxs)(t.p,{children:["Array of TSVs containing SV counts for each sample, i.e. ",(0,n.jsx)(t.code,{children:"sample-svtype-count"})," triplets. Each file corresponds to\na different SV caller."]}),"\n",(0,n.jsx)(t.h4,{id:"sv_count_plots",children:(0,n.jsx)(t.code,{children:"sv_count_plots"})}),"\n",(0,n.jsx)(t.p,{children:"Array of images plotting SV counts stratified by SV type. Each file corresponds to a different SV caller."}),"\n",(0,n.jsx)(t.h4,{id:"outlier_samples_excluded_file",children:(0,n.jsx)(t.code,{children:"outlier_samples_excluded_file"})}),"\n",(0,n.jsx)(t.p,{children:"Text file of sample IDs excluded by outlier analysis."}),"\n",(0,n.jsx)(t.h4,{id:"filtered_batch_samples_file",children:(0,n.jsx)(t.code,{children:"filtered_batch_samples_file"})}),"\n",(0,n.jsx)(t.p,{children:"Text file of remaining sample IDs after outlier exclusion."})]})}function f(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},1944(e,t,i){i.d(t,{$:()=>n});var l=i(4848);const n=({children:e})=>(0,l.jsx)("span",{style:{backgroundColor:"var(--highlight-optional-arg-background-color)",borderRadius:"2px",color:"var(--highlight-optional-arg-text-color)",padding:"0.2rem"},children:e})},8453(e,t,i){i.d(t,{R:()=>s,x:()=>o});var l=i(6540);const n={},r=l.createContext(n);function s(e){const t=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),l.createElement(r.Provider,{value:t},e.children)}}}]);