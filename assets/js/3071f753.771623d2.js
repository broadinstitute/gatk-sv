"use strict";(globalThis.webpackChunkGATK_SV=globalThis.webpackChunkGATK_SV||[]).push([[3963],{4788:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"modules/genotype_batch","title":"GenotypeBatch","description":"Genotype Batch","source":"@site/docs/modules/genotype_batch.md","sourceDirName":"modules","slug":"/modules/gb","permalink":"/gatk-sv/docs/modules/gb","draft":false,"unlisted":false,"editUrl":"https://github.com/broadinstitute/gatk-sv/tree/master/website/docs/modules/genotype_batch.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"title":"GenotypeBatch","description":"Genotype Batch","sidebar_position":9,"slug":"gb"},"sidebar":"tutorialSidebar","previous":{"title":"MergeBatchSites","permalink":"/gatk-sv/docs/modules/msites"},"next":{"title":"RegenotypeCNVs","permalink":"/gatk-sv/docs/modules/rgcnvs"}}');var d=n(4848),s=n(8453);const r={title:"GenotypeBatch",description:"Genotype Batch",sidebar_position:9,slug:"gb"},c=void 0,o={},l=[{value:"Inputs",id:"inputs",level:3},{value:"<code>batch</code>",id:"batch",level:4},{value:"<code>batch_pesr_vcf</code>",id:"batch_pesr_vcf",level:4},{value:"<code>batch_depth_vcf</code>",id:"batch_depth_vcf",level:4},{value:"<code>cohort_pesr_vcf</code>",id:"cohort_pesr_vcf",level:4},{value:"<code>cohort_depth_vcf</code>",id:"cohort_depth_vcf",level:4},{value:"<code>n_per_split</code>",id:"n_per_split",level:4},{value:"<code>coveragefile</code>",id:"coveragefile",level:4},{value:"<code>medianfile</code>",id:"medianfile",level:4},{value:"<code>rf_cutoffs</code>",id:"rf_cutoffs",level:4},{value:"<code>seed_cutoffs</code>",id:"seed_cutoffs",level:4},{value:"<code>n_RD_genotype_bins</code>",id:"n_rd_genotype_bins",level:4},{value:"<code>discfile</code>",id:"discfile",level:4},{value:"<code>reference_build</code>",id:"reference_build",level:4},{value:"<code>sr_median_hom_ins</code>",id:"sr_median_hom_ins",level:4},{value:"<code>sr_hom_cutoff_multiplier</code>",id:"sr_hom_cutoff_multiplier",level:4},{value:"Outputs",id:"outputs",level:3},{value:"<code>sr_bothside_pass</code>",id:"sr_bothside_pass",level:4},{value:"<code>sr_background_fail</code>",id:"sr_background_fail",level:4},{value:"<code>trained_PE_metrics</code>",id:"trained_pe_metrics",level:4},{value:"<code>trained_SR_metrics</code>",id:"trained_sr_metrics",level:4},{value:"<code>trained_genotype_*_*_sepcutoff</code>",id:"trained_genotype___sepcutoff",level:4},{value:"<code>genotyped_depth_vcf</code>",id:"genotyped_depth_vcf",level:4},{value:"<code>genotyped_pesr_vcf</code>",id:"genotyped_pesr_vcf",level:4},{value:"<code>regeno_coverage_medians</code>",id:"regeno_coverage_medians",level:4}];function a(e){const i={a:"a",admonition:"admonition",code:"code",h3:"h3",h4:"h4",mermaid:"mermaid",p:"p",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.p,{children:(0,d.jsx)(i.a,{href:"https://github.com/broadinstitute/gatk-sv/blob/main/wdl/GenotypeBatch.wdl",children:"WDL source code"})}),"\n",(0,d.jsxs)(i.p,{children:["Genotypes a batch of samples across all variants in the cohort. Note that while the preceding step\n",(0,d.jsx)(i.a,{href:"./msites",children:"MergeBatchSites"}),' is a "cohort-level" module, genotyping is performed on one batch of samples at a time.']}),"\n",(0,d.jsx)(i.p,{children:"In brief, genotyping is performed by first training variant metric cutoffs on sites with clear evidence signatures,\nand then genotypes and genotype qualities are assigned based on parametric models tuned with these cutoffs. This is\nperformed separately for PE/SR calls and depth-based calls."}),"\n",(0,d.jsx)(i.p,{children:"The following diagram illustrates the recommended invocation order:"}),"\n",(0,d.jsx)(i.mermaid,{value:"\nstateDiagram\n  direction LR\n  \n  classDef inModules stroke-width:0px,fill:#caf0f8,color:#00509d\n  classDef thisModule font-weight:bold,stroke-width:0px,fill:#ff9900,color:white\n  classDef outModules stroke-width:0px,fill:#caf0f8,color:#00509d\n\n  mbs: MergeBatchSites\n  gb: GenotypeBatch\n  rgc: RegenotypeCNVs\n  mbs --\x3e gb\n  gb --\x3e rgc\n  \n  class gb thisModule\n  class mbs inModules\n  class rgc outModules"}),"\n",(0,d.jsx)(i.h3,{id:"inputs",children:"Inputs"}),"\n",(0,d.jsx)(i.admonition,{type:"info",children:(0,d.jsx)(i.p,{children:"A number of inputs to this module are only used in single-sample mode and therefore omitted here. In addition, some\ninputs marked as optional in the WDL are required for joint calling."})}),"\n",(0,d.jsx)(i.h4,{id:"batch",children:(0,d.jsx)(i.code,{children:"batch"})}),"\n",(0,d.jsxs)(i.p,{children:["An identifier for the batch. Should match the name used in ",(0,d.jsx)(i.a,{href:"./gbe#batch",children:"GatherBatchEvidence"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"batch_pesr_vcf",children:(0,d.jsx)(i.code,{children:"batch_pesr_vcf"})}),"\n",(0,d.jsxs)(i.p,{children:["Batch PE/SR caller variants after filtering, generated in ",(0,d.jsx)(i.a,{href:"./fb#filtered_pesr_vcf",children:"FilterBatch"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"batch_depth_vcf",children:(0,d.jsx)(i.code,{children:"batch_depth_vcf"})}),"\n",(0,d.jsxs)(i.p,{children:["Batch depth caller variants after filtering, generated in ",(0,d.jsx)(i.a,{href:"./fb#filtered_depth_vcf",children:"FilterBatch"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"cohort_pesr_vcf",children:(0,d.jsx)(i.code,{children:"cohort_pesr_vcf"})}),"\n",(0,d.jsxs)(i.p,{children:["Merged PE/SR caller variants for the cohort, generated in ",(0,d.jsx)(i.a,{href:"./msites#cohort_pesr_vcf",children:"MergeBatchSites"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"cohort_depth_vcf",children:(0,d.jsx)(i.code,{children:"cohort_depth_vcf"})}),"\n",(0,d.jsxs)(i.p,{children:["Merged depth caller variants for the cohort, generated in ",(0,d.jsx)(i.a,{href:"./msites#cohort_depth_vcf",children:"MergeBatchSites"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"n_per_split",children:(0,d.jsx)(i.code,{children:"n_per_split"})}),"\n",(0,d.jsx)(i.p,{children:"Records per shard when scattering variants. Decrease to increase parallelism if the workflow is running slowly."}),"\n",(0,d.jsx)(i.h4,{id:"coveragefile",children:(0,d.jsx)(i.code,{children:"coveragefile"})}),"\n",(0,d.jsxs)(i.p,{children:["Merged RD evidence file from ",(0,d.jsx)(i.a,{href:"./gbe#merged_bincov",children:"GatherBatchEvidence"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"medianfile",children:(0,d.jsx)(i.code,{children:"medianfile"})}),"\n",(0,d.jsxs)(i.p,{children:["Merged median coverage table from ",(0,d.jsx)(i.a,{href:"./gbe#median_cov",children:"GatherBatchEvidence"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"rf_cutoffs",children:(0,d.jsx)(i.code,{children:"rf_cutoffs"})}),"\n",(0,d.jsxs)(i.p,{children:["Genotyping cutoffs trained with the random forest filtering model from ",(0,d.jsx)(i.a,{href:"./fb#cutoffs",children:"FilterBatch"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"seed_cutoffs",children:(0,d.jsx)(i.code,{children:"seed_cutoffs"})}),"\n",(0,d.jsxs)(i.p,{children:["See ",(0,d.jsx)(i.a,{href:"/docs/resources#seed_cutoffs",children:"here"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"n_rd_genotype_bins",children:(0,d.jsx)(i.code,{children:"n_RD_genotype_bins"})}),"\n",(0,d.jsx)(i.p,{children:"Number of depth genotyping bins. Most users should leave this at the default value."}),"\n",(0,d.jsx)(i.h4,{id:"discfile",children:(0,d.jsx)(i.code,{children:"discfile"})}),"\n",(0,d.jsxs)(i.p,{children:["Merged PE evidence file from ",(0,d.jsx)(i.a,{href:"./gbe#merged_pe",children:"GatherBatchEvidence"}),"."]}),"\n",(0,d.jsx)(i.h4,{id:"reference_build",children:(0,d.jsx)(i.code,{children:"reference_build"})}),"\n",(0,d.jsx)(i.p,{children:'Reference build version. Only "hg38" is supported.'}),"\n",(0,d.jsx)(i.h4,{id:"sr_median_hom_ins",children:(0,d.jsx)(i.code,{children:"sr_median_hom_ins"})}),"\n",(0,d.jsx)(i.p,{children:"Median normalized split read counts of homozygous insertions. Most users should leave this at the default value."}),"\n",(0,d.jsx)(i.h4,{id:"sr_hom_cutoff_multiplier",children:(0,d.jsx)(i.code,{children:"sr_hom_cutoff_multiplier"})}),"\n",(0,d.jsx)(i.p,{children:"Cutoff multiplier for split read counts of homozygous insertions. Most users should leave this at the default value."}),"\n",(0,d.jsx)(i.h3,{id:"outputs",children:"Outputs"}),"\n",(0,d.jsx)(i.h4,{id:"sr_bothside_pass",children:(0,d.jsx)(i.code,{children:"sr_bothside_pass"})}),"\n",(0,d.jsx)(i.p,{children:"List of variant IDs with split reads found on both sides of the breakpoint."}),"\n",(0,d.jsx)(i.h4,{id:"sr_background_fail",children:(0,d.jsx)(i.code,{children:"sr_background_fail"})}),"\n",(0,d.jsx)(i.p,{children:"List of variant IDs exhibiting low signal-to-noise ratio for split read evidence."}),"\n",(0,d.jsx)(i.h4,{id:"trained_pe_metrics",children:(0,d.jsx)(i.code,{children:"trained_PE_metrics"})}),"\n",(0,d.jsx)(i.p,{children:"PE evidence genotyping metrics file."}),"\n",(0,d.jsx)(i.h4,{id:"trained_sr_metrics",children:(0,d.jsx)(i.code,{children:"trained_SR_metrics"})}),"\n",(0,d.jsx)(i.p,{children:"SR evidence genotyping metrics file."}),"\n",(0,d.jsx)(i.h4,{id:"trained_genotype___sepcutoff",children:(0,d.jsx)(i.code,{children:"trained_genotype_*_*_sepcutoff"})}),"\n",(0,d.jsx)(i.p,{children:"Trained genotyping cutoffs for variants called by PESR or depth when supported by PESR or depth evidence (4 total)."}),"\n",(0,d.jsx)(i.h4,{id:"genotyped_depth_vcf",children:(0,d.jsx)(i.code,{children:"genotyped_depth_vcf"})}),"\n",(0,d.jsx)(i.p,{children:"Genotyped depth call VCF."}),"\n",(0,d.jsx)(i.h4,{id:"genotyped_pesr_vcf",children:(0,d.jsx)(i.code,{children:"genotyped_pesr_vcf"})}),"\n",(0,d.jsx)(i.p,{children:"Genotyped PE/SR call VCF."}),"\n",(0,d.jsx)(i.h4,{id:"regeno_coverage_medians",children:(0,d.jsx)(i.code,{children:"regeno_coverage_medians"})}),"\n",(0,d.jsx)(i.p,{children:"Coverage metrics for downstream CNV regenotyping."})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,d.jsx)(i,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>r,x:()=>c});var t=n(6540);const d={},s=t.createContext(d);function r(e){const i=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);